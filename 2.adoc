= Markup editor: Rešerše + Hi-Fi prototyp
Šmolík Jaroslav, Uhnák Peter, Špak Maroš, Chmelař Petr
Semestrální projekt MI-NUR
:icons: font
:toc:

include::_about.adoc[]

=== Autoři
 *Šmolík Jaroslav* (vedoucí týmu)::
    * mailto:smolijar@fit.cvut.cz[]
    * TODO co delal
 Uhnák Peter::
    * mailto:uhnakpet@fit.cvut.cz[]
    * TODO co delal
 Špak Maroš::
    * mailto:spakmaro@fit.cvut.cz[]
    * TODO co delal
 Chmelař Petr::
    * mailto:chmelpe7@fit.cvut.cz[]
    * TODO co delal

== Rešerše konkurence

=== Acme editor (example)

Short description. link:+http://acme.com+[Acme editor]

==== Porovnání rozdílů
Contrast of the Acme editor, compared to Markup Editor.
e.g. Acme editor is a desktop app and not web component;
or Acme editor is only Markdown editor and does not handle other LMLs;
or Acme editor is WYSIWYG and requires extensive mouse usage etc.

==== Zajímavé features
Optional intro.
Focus on cool features or features that stand out, compared to other products.

. outstanding feature a
+
Optional description
. outstanding feature b

==== Zhodnocení UI
Discuss interesting (both good and bad) features of UI.
Inlcude screenshots, comment, explain why good/bad, optionally suggest improvement.

==== Pozorování UI v kontextu markup-editor
Are there some UI elements we have as well?
Do they look similiar and provide similliar interaction?
If not, focus on those elements and briefly sum up differences.
The existing projects might (do not have to though) better (more conventional, user tested) implementation of UI elements.
Is there something we should consider for our UI?
(Have a look at things like status bar, command palette, common shortcuts, toolbar, image/table manipulation, etc.)

===== UI feature 1

.Image caption
image::http://www.tidy-mind.com/wp-content/uploads/2013/06/2013-06-25_142513-624x459.png[]

Feature description

==== Shrnutí

===== Plusy
. Plus A
+
Optional description
. Plus B

===== Mínusy
. Minus A
. Minus B

=== GitBook

Desktopový (free) a online (placený) editor pro markupové dokumenty ve formátu GFM (GitHub Flavored Markdown) a AsciiDoc.

Navíc k editaci dokumentů umožňuje správu celých knih. Resp. používá metaforu knihy na rozdělení projektu do kapitol, případně do souborů.

Na pozadí GitBook verzuje dokumenty pomocí gitu. Prohlížení změn dokumentu je tak pohled nad git commity.

link:+https://www.gitbook.com/editor+[GitBook]

==== Porovnání rozdílů

. GitBook je stand-alone produkt - jak desktopová, tak webová verze. Nelze jej tudíž embedovat do jiných stránek.
. Neobsahuje command palette, místo toho má markdown paletu pro vkládání základních markupových konstruktů.
* GitBook umožňuje kód editovat nejen v source+preview módu, ale i jako WYSIWYG.
. Obsahuje dialog pro vkládání obrázků, které lze načítat z lokální knihovny, disku, či vzdálené adresy

==== Zhodnocení UI

===== Základní pohled

image:/assets/zakladni-ui.png[]

Základní UI zobrazuje ve své horní části toolbar, konfiguraci verzí a markdown paletu.
Zbytek okna pak zabírá sidebar s obsahem (TOC) nebo adresářovou strukturou (FILES), a konečně editorem samotným.

Ve výchozím módu je editor v módu WYSIWYG, tedy lze přímo psát do naformátovaného textu a využívat markup palety a klávesových zkratek.

===== Editace markupu

Pro přímou editaci markupu musíme kliknout na nenápadný otazníček v pravém dolním rohu a zvolit _Edit Markdown_. Stejným způsobem se můžeme vrátit k WISIWYGu.
Při editaci zdroje se hlavní část UI rozdělí na zdroj a preview (lze vypnout v konfiguraci).

image:/assets/editace-markup.png[]

Nutno podotknout, že mód WYSIWYGu je dostupný pouze pro Markdown, ačkoliv GitBook podporuje i AsciiDoc. AsciiDoc je vždy v módu editace zdroje.
Preview okno je opravdu jenom preview, a nelze v něm editovat text. Toto považuji za škodu; když už GitBook podporuje WYSIWYG, bylo by zajímavé mít v jedné polovině editovatelný zdrojový kód, a v pravé polovině editovatelný WISIWYG.

===== Scrollování

Co je určitě nedostatkem preview je nemožnost odscrollování zdroje na správnou pozici když na něco kliknu v preview. Rovněž synchronizované scrollování funguje pouze při scrollování zdroje, nikoliv preview. U dokumentů s obrázky (kde je preview mnohem delší než markup) je navíc vidět, že "synchronizace" je implementována hloupou interpolací, kdy obě okna scrollují o stejné relativní množství. Je tedy možné být odscrollovaný na markup a editovat jej bez možnosti vidět preview. Jako bonus scrollování nejde vypnout.

===== Vyhledávání v textu

**Editor postrádá jakoukoliv možnost vyhledávání v textu!**

===== Markup paleta a zkratky

Markupová paleta je dostupná jednak v pravé horní části obrazovky, a jednak v horním menu pod "Markup". Chování je ale velmi nekonzistentní obecně, a také mezi WYSIWYGem a markup editorem.

Ve WYSIWYG módu se některé zkratky/položky chovají podle očekávání, např. bold (nebo ctrl+b) přepne bold na označeném textu. Jiné se však chovají překvapivě.

Pro příklad uvedu případ _Numbered List_ a _Bulleted List_.

Při kliknutí na ikonku Numbered list (v markup paletě), text pod kurzorem se změní na číslovaný seznam. Pokud na tlačítko kliknu znovu, pak číslovaný seznam zmizí. Stejně tak pokud bych místo toho klikl na ikonku Bulleted list, pak by se číslovaný seznam změnil na nečíslovaný.

Pokud ale provedu to samé klikáním na položky Markup v horním menu, nebo použiji patřičných klávesových zkratek, pak místo odstranění/změny se seznam začne zanořovat do sebe.

image:/assets/bullet-zanoreni.png

Další nepříjemnost je při odstraňování seznamu, kdy stisknutí backspace sice smaže jednu úroveň zanoření, ale kurzor v textu odskočí na předchozí řádek.

Plus pro seznamy je alespoň automatické vytvoření nové položky v seznamu při stisknutí enter, a možnost zvětšování/zmenšování zanoření tabem/shift+tabem. Musím ale podotknout, že během zkoumání chování seznamů se mi podařilo vyvolat chybu, kdy stiknutí editoru sice novou položku vytvářelo, ale kurzor neposkočil.

Pokud jde o chování palety/zkratek v editoru markupu, pak je situace ještě o poznání horší.
Z palety zmizí tlačítko pro vkládání tabulky, ale v menu položka _Insert Table..._ zůstala. Kliknutí na toto tlačítko ovšem nic neudělá.
Podobně i tlačítko pro _Horizontal Rule_, které sice z palety nezmizelo, ale kliknutí na tlačítko (nebo položku v menu) nic neudělá (př. pokud je kurzor na prázdném řádku, pak je řádek odstraněn).

Jako bonus z palety zmizí nadpisy H4-H6 (mimochodem pro WYSIWYG paleta obsahuje H1-H6 a menu H1-H5) spolu se zkratkami.

Celkové používání zkratek či palety v markup editoru je skoro až zbytečné, protože GitBook pouze tupě obalí označený text patřičnou syntaxí. Kombinace některých zkratek (např. bold + italic + bold) pak může vést k pomeřně nežádoucím výsledkům.

image:/assets/not-so-bold.png[]

===== Vkládání obrázků

Vhodné bylo rozhrání pro vkládání obrázků. Při vkládání vzdálených obrázků uživatel vidí preview.

image:/assets/insert-link-image.png[]

Při vkládání lokálních obrázků pak GitBook zkopíruje daný soubor do git repozitáře s editovanou knihou (dokumentem), což je velmi příjemná vlastnost.

===== Rozdíly mezi verzemi

Verzování dokumentů je poháněno gitem a GitBook umožňuje zobrazit rozdíly mezi verzemi či mezi nimi přecházet.

Je možno zobrazovat změny verzí jak pro celou knihu, tak i pro jednotlivé soubory.

image:/assets/verze-knihy.png[]

V diffu výše je vidět, že zvolený způsob prokládání přidaného a odebraného obsahu není úplně vhodný pro text, neboť je těžké číst jak jednu, tak i druhou variantu.

image:/assets/verze-souboru.png[alt=""]

Při prohlížení verze souboru (_THIS FILE_) mi ale verzování zobrazuje hned čtyři soubory. Toto je velmi matoucí a nepodařilo se mi dohledat co přesně tím autoři mysleli. Mimochodem na záložku _n COMMIT(S)_ nelze kliknout.

==== Pozorování UI v kontextu markup-editor

Na rozdíl od markup-editoru se jedná o standalone produkt, nicméně sdílejí spolu značnou část funkcionality.
Konceptuálně jsou si oba nástroje velmi podobné, i typické použítí je velmi podobné.
  * editace markupu s preview; oboje možné nezávisle vypnout
  * zobrazení outline/table of contents
  * zobrazování rozdílu mezi verzemi
  * toolbar
  * ovládání klávesovými zkratkami

* Table Of Contents je vytvářena uživatelem a není spojená s kapitolami v markup dokumentu
* Chybí fuzzy příkazové okno pro ovládání nástroje
* GitBook má nastavení a ovládání různě roztroušené po UI a menu.
* Není žádná podpora pro tabulky v markup editoru, pouze ve WYSIWYGu pro Makrdown.
* Okno pro vkládání obrazků je alespoň trochu použitelné.


===== Chyby v markupu

Pokud uživatel omylem napíše chybnou syntaxi která neumožňuje správné vykreslení preview, tak editor na situaci nijak nereaguje a nadále zobrazuje poslední úspěšný preview. Očekával bych alespoň popup "nelze vytvořit preview". Takto si toho může uživatel všimnout až po značné chvíli a musí zjišťovat problém metodou pokus-omyl.

==== Shrnutí

Ač se v principu jedná o zajímavý nástroj, za kterým stojí i velký hráč (GitHub), překvapilo mě jak téměř až amatérsky je nástroj zpracovaný.

===== Plusy

. WYSIWYG editor - uživatelské možnosti jsou omezeny možnostmi markupu pod tím, takže se skutečně jedná o WYSIWYG a WYWIWYG (What You Want Is What You Get) zároveň
. Organizace dokumentů do formátu knihy
. Automatické verzování gitem

===== Mínusy

. nekonzistentní funkčnost markup palety a klávesových zkratek
. naivní scrollování
. chybějící podpora pro tabulky v markup editor módu
. přepínaní na jiné okno (či z jiného okna) v systému skryje horní toolbar, takže obsah celého okna vždy poskočí, což je poněkud nepříjemné
. Nevhodně zobrazné diffy mezi verzemi
. Žádné upozornění na chybu v syntaxi


=== Ace editor

Ace editor je široce využívaná embedovatelná komponenta pro editaci zdrojového kódu. Komponenta byla původně vytvořena pro webové IDE pro vývoj aplikací link:https://c9.io/[Cloud9]. Nicméně je využívána i na dalších portálech a nástrojích, jako například GitHub nebo R Studio.

link:https://ace.c9.io/[]

==== Porovnání rozdílů

. Ace je čistě editor pro text/kód
. Nejsou zde nijak řešeny markup-specifické záležitosti jako outline, preview, atp.
. Jedná se o velmi propracovaný textový editor s velkou rozšířitelností

==== Zhodnocení UI

Pro lepší porovnání na pár místech ukazuji i praktické nasazení Ace editoru v různých nástrojích.

===== Základní pohled

Webová stránka Ace nabízí takzvanou "kuchyň" na které si uživatel může vyzkoušet různé základní vlastnosti:

image:/assets/ace-zakladni-ui.png[]

Editor v základní podobě nabízí spoustu vlastností:

. syntax highlighting
. číslování řádků
. možnost zabalovat/rozbalovat text podle syntaxe
. zobrazování neviditelných znaků
. zobrazování aktuální pozice (pravý dolní roh), případně i pozici označeného textu
. soft wrap indikátor (šedá vertikální čára v 80 sloupci textu)

Rovněž umožňuje i barvení code snippetů uvnitř markup code bloků:

image:/assets/ace-barveni-v-kodu.png[]

===== Klávesové ovládání

Editor sám o sobě nemá žádné klávesové zkratky pro vkládání syntaktických konstruktů, nicméně má velmi propracovanou klávesovou podporu pro editaci textu. Lze například nastavit mód _vim_, v kterém lze používat vim přikazy nejen pro navigaci (`3w`, `10j`, `67G`, …), ale i pro editaci textu (`dap`, `di{)`, `3yy`, `p`, …), což obzvlášť ocení náročnější uživatelé.
Dokonce podporuje i některé ex příkazy jako například search & replace:

image:/assets/ace-vim-ex.png[]

Ace umožňuje plně konfigurovat klásové zkratky pro běžný mód, i pro speciální módy jako je již zmíněný vim, či emacs.

===== Náhled změn

Ace rovněž nabízí možnost zobrazování rozdílů v textu/mezi verzemi. Zde například editor použitý na webu GitHub v read-only módu zobrazující změny mězi dvěma verzemi souboru.

image:/assets/ace-nahled-zmen.png[]

===== Rozšiřování editoru

Jednou ze silných stránek editoru je rozšířitelnost a tudíž i široká aplikovatelnost.

image:/assets/ace-rstudio.png[]

Na obrázku je Ace editor embedovaný do nástroje R Studio. Uvnitř editoru je každý `R` code blok obohacen o tlačítka ke konfiguraci či spuštění. Po spuštění uvedeného příkladu se přímo do editoru vloží vykreslený graf.

==== Pozorování UI v kontextu markup-editor

Ace editor lze srovnat pouze s textovou částí markup-editoru. V této části se významně překrývají.

. vyhledávání v dokumentu
. klávesové zkratky
. syntax highlighting
. status bar
. diff view
. číslování řádek
. a mnoho dalšího

Ace by bylo možno zvolit i jako základ pro textový editor markup-editoru.

==== Shrnutí

===== Plusy
. Bohatá rozšířitelnost se spoustou pluginů
. I v základní podobě velmi silný textový editor
. Možnost zobrazovat rich content (např. obrázky) přímo v editoru
. vim mód

===== Mínusy
. Nutná značná investice do učení se API pro tvorbu vlastních rozšíření


== Hi-fi prototyp
